This repo was created for personal use, or use by those on NixOS or those using Nix package manager. I say this because I made this specifically for ingesting in a sister repo that I'm using as a Nix flake, thus I can't be sure of the functionality on other platforms.

The idea was to have a mesa-git build run every night against the latest commit at the time of execution and create a tarball that includes the latest LLVM and other important libraries. This was originally being compiled on Ubuntu because it would imitate the environment that Steam Linux Runtime is built against - however, I found that FSR 4 was not working reliably. Instead of going through the trouble of continuing to troubleshoot Ubuntu and figure out what I did wrong, or if it was even able to be fixed, I refactored entirely into Nix. I'm still bundling the same libraries that were bundled with Ubuntu, just building against Nix's libraries and importing those. However, by not bundling EVERY library, I'm not sure if it will work on other platforms outside of the Nix package manager. Also - while this may build nightly, my flake is set to only grab the latest release from this repo every Wednesday at 6AM UTC (1AM EST). Helps prevent shaders from being obsolete a day later (I have a script that runs on my local to remove shaders if a driver update is detected), and gives time in case a bug was introduced in a build from Friday, yet fixed in a build on Monday.

Now onto the reason this exists: Chaotic-Nyx was archived a short while ago, and provided mesa-git to NixOS on the system-level. I hadn't cared at first, but I had crashes on Mesa 25.3.2 when trying to play Monster Hunter Wilds (9070 XT, 9950X3D - if you have a similar build) and decided I'd try my hand at vibe coding this to fix the issue. My thoughts were simple; I knew from past experience that different versions of Mesa could be pointed at by setting the VK_ICD_FILENAMES variable. This meant that the package didn't NEED to be built against Nix's libraries or integrated with the system. So the reason that this tarball exists is not to "replace" the system-level stable Mesa, but to provide an alternative "portable" driver for those on modern hardware or those that just want to use the latest Mesa without having to worry about system-level conflicts.

All that being said, as I've said, this was built with the express purpose of deploying on NixOS / Nix systems. If there are issues with this on other platforms, feel free to submit a PR to fix them, but I plan to use this solely to power my portable-mesa-git-nix flake in my other repo: https://github.com/powerofthe69/portable-mesa-git-nix. As far as I'm aware, Nix is a package manager that would allow installation of this via the flake on other distributions, if nobody wants to go through the effort of dealing with their specific platform's quirks and incompatibilities.

I may also add a native Nix module to this, but I haven't looked into how caching packages works as I don't mind using the package through an environment variable, especially if I just set the variable globally or per application.

Also, I'm not super smart or knowledgeable about this stuff, so most of this was done with trial and error alongside Gemini and Claude. If there are inefficiencies or areas of improvement, please submit a PR to fix them. Thank you!
